#!/bin/bash
for FILE in /usr/local/Warehouse/stock/*; 
do
	source $FILE
done

for FILE in /usr/local/Warehouse/refurbish/*;
do
	source $FILE
done

for FILE in /usr/local/Warehouse/return/*;
do
	source $FILE
done

if [ "$1" == "order" ];
then
	if [ "$2" == "a52dec" ];
	then
		a52dec_install

	elif [ "$2" == "aalib" ];
	then
		aalib_install
	elif [ "$2" == "aardvark_shell_utils" ];
	then
		aardvark_install
	elif [ "$2" == "abcm2ps" ];
	then
		abcm2ps_install
	elif [ "$2" == "abcmidi" ];
	then
		abcmidi_install
	elif [ "$2" == "ack" ];
	then
		ack_install
	else
		echo -e "\033[91;1;4mError: Product not in stock \033[0m"
		echo "Try refurbishing (maintaining, updating) VirtualShip."
	fi
		
elif [ "$1" == "refurbish" ];
then
	if [ "$2" == "ship" ];
	then
		maintain
		rm -rf /usr/local/Warehouse/maintain.sh
		rm -rf /usr/local/Warehouse/requirements.txt
		rm -rf /usr/local/Warehouse/return.sh
		rm -rf /usr/local/Warehouse/refurbish.sh
	elif [ "$2" == "a52dec" ];
	then
		a52dec_update
	elif [ "$2" == "aalib" ];
	then
		aalib_update
	elif [ "$2" == "aardvark_shell_utils" ];
	then
		aardvark_update
	elif [ "$2" == "abcm2ps" ];
	then
		abcm2ps_update
	elif [ "$2" == "abcmidi" ];
	then
		abcmidi_update
	elif [ "$2" == "ack" ];
	then
		ack_update
	else
		echo -e "\033[91;1;4mError: Product not in stock \033[0m"
		fi
elif [ "$1" == "return" ];
then
	if [ "$2" == "a52dec" ];
	then
		un_a52dec
	elif [ "$2" == "aalib" ];
	then
		un_aalib
	elif [ "$2" == "aardvark_shell_utils" ];
	then
		un_aardvark
	elif [ "$2" == "abcm2ps" ];
	then
		un_abcm2ps
	elif [ "$2" == "abcmidi" ];
	then
		un_abcmidi
	elif [ "$2" == "ack" ];
	then
		un_ack
	else
		echo "Error: product not in stock"
	fi
elif [ "$1" == "backorder" ];
then
	if [ "$2" == "" ];
	then
		echo -e "\033[91;1;4mError: Backorder not understood \033[0m"
	else
		echo "Please describe the product below:"
		echo ""
		read description
		gh issue create --label enhancement --title "Request for $2 stock" --body "$description" --repo https://github.com/VirtualShip/Core
		echo "Backorder created!"
	fi
else
	echo -e "\033[91;1;4mError: Command not understood \033[0m"
	fi

#!/bin/bash
for FILE in /usr/local/Warehouse/stock/*; 
do
	chmod +x $FILE
done

for FILE in /usr/local/Warehouse/refurbish/*;
do
	chmod +x $FILE
done

for FILE in /usr/local/Warehouse/return/*;
do
	chmod +x $FILE
done

if [ "$1" == "order" ];
then
	if [ -f "/usr/local/Warehouse/stock/$2_install.sh" ];
	then
		cd /usr/local/Warehouse/stock
		./"$2"_install.sh
	else
		echo -e "\033[91;1;4mError: Product not in stock \033[0m"
		echo "Try refurbishing (maintaining, updating) VirtualShip."
	fi
		
elif [ "$1" == "refurbish" ];
then
	if [ "$2" == "ship" ];
	then
		cd /usr/local/Warehouse/refurbish
		./maintain.sh 
		rm /usr/local/Warehouse/maintain.sh
		sudo chmod -R 777 /usr/local/Warehouse
		echo -e "\033[92;1;4müè° Package received! VirtualShip succesfully refurbished. \033[0m"
		sleep 2
	elif [ -f "/usr/local/Warehouse/refurbish/$2.sh" ];
	then
		cd /usr/local/Warehouse/refurbish
		./"$2".sh 
	else
		echo -e "\033[91;1;4mError: Product not in stock \033[0m"
		echo "Try refurbishing (maintaining, updating) VirtualShip."
	fi

elif [ "$1" == "return" ];
then
	if [ -f "/usr/local/Warehouse/return/$2.sh" ];
	then
		cd /usr/local/Warehouse/return
		./"$2".sh 
	else
		echo -e "\033[91;1;4mError: Product not in stock \033[0m"
		echo "Try refurbishing (maintaining, updating) VirtualShip."
	fi

elif [ "$1" == "backorder" ];
then
	if [ "$2" == "" ];
	then
		echo -e "\033[91;1;4mError: Backorder not understood \033[0m"
	else
		echo "Please describe the product below:"
		echo ""
		read description
		gh issue create --label enhancement --title "Request for $2 stock" --body "$description" --repo https://github.com/VirtualShip/Core
		echo "Backorder created!"
	fi
else
	echo -e "\033[91;1;4mError: Command not understood \033[0m"
	fi
